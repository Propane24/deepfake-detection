<!DOCTYPE html>
<html>
<head>
    <title>Deepfake Detection Demo</title>

    <style>
        body{
            background:#0f0f0f;
            color:white;
            font-family:Arial;
            text-align:center;
        }

        h1{
            margin-top:20px;
        }

        .gallery{
            display:flex;
            flex-wrap:wrap;
            justify-content:center;
            gap:20px;
            margin-top:30px;
        }

        .imgBox{
            position:relative;
        }

        img{
            width:260px;
            border-radius:12px;
            cursor:pointer;
            transition:0.2s;
        }

        img:hover{
            transform:scale(1.03);
        }

        .badge{
            position:absolute;
            top:10px;
            left:10px;
            padding:6px 10px;
            border-radius:8px;
            font-weight:bold;
            font-size:14px;
            background:black;
            opacity:0.85;
        }

        button{
            margin-top:25px;
            padding:10px 20px;
            font-size:16px;
            cursor:pointer;
            border-radius:8px;
            border:none;
            background:#00c3ff;
            color:white;
        }
    </style>
</head>

<body>

<h1>Real-Time Deepfake Detection</h1>
<p>Click any image to analyze</p>

<button onclick="scanAll()">Scan All Images</button>

<div class="gallery" id="gallery">

    <!-- MIXED IMAGES -->
    <div class="imgBox">
        <img src="images/img1.jpg" onclick="analyze(this)">
    </div>

    <div class="imgBox">
        <img src="images/img2.jpg" onclick="analyze(this)">
    </div>

    <div class="imgBox">
        <img src="images/img3.jpg" onclick="analyze(this)">
    </div>

    <div class="imgBox">
        <img src="images/img4.jpg" onclick="analyze(this)">
    </div>

    <div class="imgBox">
        <img src="images/img5.jpg" onclick="analyze(this)">
    </div>

</div>

<script>

async function analyze(imgElement){

    // remove old badge
    let old = imgElement.parentElement.querySelector(".badge");
    if(old) old.remove();

    const res = await fetch(imgElement.src);
    const blob = await res.blob();

    const formData = new FormData();
    formData.append("file", blob);

    const response = await fetch("http://127.0.0.1:8000/analyze",{
        method:"POST",
        body:formData
    });

    const data = await response.json();

    const badge = document.createElement("div");
    badge.className="badge";

    if(data.label==="FAKE"){
        badge.style.background="red";
    }else{
        badge.style.background="green";
    }

    badge.innerText = data.label + " ("+data.confidence.toFixed(2)+")";

    imgElement.parentElement.appendChild(badge);
}

function scanAll(){
    const imgs = document.querySelectorAll("img");
    imgs.forEach(img=>{
        analyze(img);
    });
}

</script>

</body>
</html>
